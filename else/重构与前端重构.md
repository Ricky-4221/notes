重构

refactoring

对软件内部结构的一种调整

目的是在不改变外部行为的前提下，提高其可理解性，降低修改成本

注意性能优化

![img](http://km.oa.com/files/photos/pictures/202007/1594549724_40_w2099_h2149.png)

衡量指标（什么时候算重构完成）：代码的行数，复杂度，耦合度，可读性，架构依赖，花费的时间，是否支持后续功能的快速叠加，解决现有因代码设计问题而无法优化的矛盾

基本技巧：1.小步前进，频繁测试，最好是单元测试

2.智能开发工具，如VSCode可以将过长的函数代码拆解

基本方面

数据级

1. 用具名常量来代替魔法数。
2. 更明确或更具信息量的名字来重命名变量。
3. 将表达式内联化。
4. 用函数来代替表达式。
5. 引入中间变量。
6. 将多用途变量转换为多个单一用途变量。
7. 使用局部变量实现局部用途而不是使用参数。
8. 将基础数据类型转化为类。
9. 将一组类型码转化为类或是枚举类型。
10. 将数组转化为对象。
11. 封装群集。
12. 用数据类替代传统记录。

语句级

1. 分解布尔表达式。
2. 将复杂的的布尔表达式转换为命名精确的布尔函数。
3. 将条件语句中不同部分中的重复代码合并。
4. 使用break或retum而不是循环控制变量
5. 嵌套的if-then-else语句中一旦知道结果就立刻退出，而不是仅仅赋一个返回值.
6. 用多态来代替条件语句（尤其是重复的case语句）。
7. 建并使用空对象，代替对空值的检测。

子程序级

1. 提取子程序。
2. 将子程序代码内联化。
3. 将冗长的子程序转化为类。
4. 用简单的算法替代复杂算法。
5. 增加参数/减少参数。
6. 将查询操作同修改操作分开来。
7. 合并功能相似的子程序，并用参数来区分他们。
8. 通过传递不同的参数,让子程序体现不同的功能。
9. 传递整个对而非特定成员。
10. 传递特定成员而非整个对象
11. 封装向下转型操作

类级

1. 将值对象改为引用对象。
2. 将引用对象改为值对象。
3. 数据初始化来代替虚函数。
4. 改变成员函数或数据的位置。
5. 特定代码提出生成派生类。
6. 将相似的代码合并起来放到基类中。

类接口

1. 将某成员子程序放到另一个类中。
2. 将一个类转化成两个。
3. 删除某个类。
4. 隐藏委托关系。
5. 去掉中间人。
6. 用委托代替缗继承。
7. 继承代替委托。
8. 引入外部子程序。
9. 引入扩展类。
10. 暴露在外的成城员变量。
11. 对不能修改的成员去掉Set 函数。
12. 隐藏在类的外部不会使用的成员函数。
13. 封装不会用到的成员函数。
14. 如果基类和派生类的代码实现相似，将二者合并。

系统级

1. 为无法控制的数据创建明确的索引源。
2. 将单向类联系改为双向类联系。
3. 将双向的类联系改为单向类联系。
4. 使用工厂函数而非简单的构造函数。
5. 用异常代替错误代码，或者反其道而行之。



前端重构

![img](http://avocado.oa.com/fconv/files/201810/3a577bc958d6327689e92bb6b4ead974.files/doc_image_4_w693_h510.jpg)

![img](http://avocado.oa.com/fconv/files/201810/3a577bc958d6327689e92bb6b4ead974.files/doc_image_7_w453_h717.jpg)

资源引用不能跨域，只能通过其他域提供的对外公共单元样式来间接引用跨域资源，比如A B页面都引用公共资源的一张背景图片，不要直接在A B的样式里写background属性，而是需要公共域样式文件里替换一个类似.g-img-xxx的class给A B使用，对图片的链接样式则统一收拢到这样的class里面

盒子模型

![img](http://avocado.oa.com/fconv/files/201810/3a577bc958d6327689e92bb6b4ead974.files/doc_image_8_w400_h300.jpg)

line-box模型

针对box盒中的content区域内部，设定其有很多行，每行一个line-box

可以帮助理解float导致父元素高度塌陷的问题

1. content内容体的高度是由每行line-box的高度决定的

2. float 元素破坏了原有的line-box模型规则，导致其自然高度垮塌
3. 但是float元素并没有脱离文档流，所以content有多行的情况下后面行的line-box要往后排，就会出现类似图文环绕的效果

![img](http://avocado.oa.com/fconv/files/201810/3a577bc958d6327689e92bb6b4ead974.files/doc_image_11_w674_h205.jpg)

弹性布局

页面如何动态适配各种分辨率的屏幕并尽可能高质量的还原设计师的原稿

大部分人会用到一些相关单位（例如百分比）去让页面动态适配屏幕

![img](http://avocado.oa.com/fconv/files/201810/3a577bc958d6327689e92bb6b4ead974.files/doc_image_12_w445_h89.jpg)

例如，A需要在B中垂直居中，且A的高度不确定

方法一：

1. B的position: relative A的position: absolute
2. A的top设为50%
3. A设置 transform: translateY(-50%) //如果PC不支持transform属性就要继续拆分结构

方法二：

flex方案：将B设置display: flex; align-items: center



移动端的页面适配

苹果率先引入viewport，即（视窗），承载页面视图的展示，并设定以逻辑像素区显示位图信息。逻辑像素是计算机模拟的虚拟像素单位，可以根据用户的放大缩小而灵活伸缩（数量不变，只改变在屏幕上的占比大小）

meta标签可以更改viewport的相关属性值来兼容展示的页面

例如<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">

device-width在手机出场的时候已经设定，基本可以默认为常量





























